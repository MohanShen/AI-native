# 快速开始指南

## 1. 创建虚拟环境（推荐）

```bash
# 创建虚拟环境
python3 -m venv venv

# 激活虚拟环境
# macOS/Linux:
source venv/bin/activate
# Windows:
# venv\Scripts\activate
```

## 2. 安装依赖

```bash
pip install -r requirements.txt
```

## 2. 准备Excel文件

将您的Excel文件放入 `knowledge_base` 目录，或启动应用后通过Web界面上传。

示例文件结构：
```
knowledge_base/
  ├── sales_data.xlsx
  ├── customer_data.xlsx
  └── ...
```

## 3. 启动应用

**注意**：确保虚拟环境已激活（命令行前应显示 `(venv)`）

```bash
python app.py
```

应用将在 `http://localhost:5000` 启动。

## 4. 使用步骤

### 步骤1：初始化
1. 打开浏览器访问 `http://localhost:5000`
2. 在"OpenAI API密钥"输入框中输入您的API密钥
3. 点击"初始化"按钮

### 步骤2：上传文件（可选）
- 如果文件已在 `knowledge_base` 目录，系统会自动加载
- 或通过Web界面上传新文件

### 步骤3：输入查询
**文本输入示例：**
- "帮我分析各地区销售趋势"
- "计算每个月的销售额总和"
- "按地区分组统计销售数据"
- "找出销售额最高的20个产品"

**语音输入：**
- 点击麦克风按钮
- 说出您的查询（支持中文）
- 系统自动识别并填入查询框

### 步骤4：查看结果
- **分析意图**：显示系统理解的分析类型
- **生成的代码**：展示自动生成的Python代码
- **执行结果**：显示分析结果
- **使用的数据列**：列出所有使用的列名

## 5. 示例查询

### 示例1：销售趋势分析
**查询**："帮我分析各地区销售趋势"

**预期结果**：
- 意图：趋势分析
- 代码：生成趋势分析Python代码
- 结果：显示各地区销售趋势统计

### 示例2：分组统计
**查询**："按地区分组统计销售额"

**预期结果**：
- 意图：分组聚合
- 代码：生成分组统计代码
- 结果：显示按地区分组的销售额统计

### 示例3：排序分析
**查询**："找出销售额最高的20个产品"

**预期结果**：
- 意图：排序
- 代码：生成排序代码
- 结果：显示Top 20产品列表

## 6. 故障排除

### 问题：无法连接
- 检查端口5000是否被占用
- 尝试使用其他端口：修改 `app.py` 中的端口号

### 问题：语音识别不工作
- 确保使用Chrome或Edge浏览器
- 检查浏览器权限（允许麦克风访问）
- 尝试使用HTTPS（某些浏览器要求）

### 问题：代码执行失败
- 检查Excel文件格式
- 确认列名是否正确
- 查看错误信息中的具体提示

## 7. 下一步

- 尝试不同的查询类型
- 上传您自己的Excel文件
- 探索各种分析功能

祝您使用愉快！

